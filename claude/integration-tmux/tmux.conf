# ============================================================================
# Claude Code - Tmux Tab Colors
# ============================================================================
#
# Colors based on @claude_status:
#   computing  ->  red        (thinking)
#   prompt     ->  yellow     (waiting for input)
#   unread     ->  brightcyan (finished, not seen)
#   idle       ->  green      (finished, seen)
#   (none)     ->  white/cyan (no Claude running)
#
# ============================================================================

# ----------------------------------------------------------------------------
# Tab Format - Inactive Windows
# ----------------------------------------------------------------------------
# Default: white | With Claude: color based on status
set -g window-status-format '\
#{?#{@claude_status},\
#[fg=#{?\
#{==:#{@claude_status},computing},red,\
#{?\
#{==:#{@claude_status},prompt},yellow,\
#{?\
#{==:#{@claude_status},unread},brightcyan,\
green}}}],\
#[fg=white]}\
#[bg=colour16,dim] #I.#W '

# ----------------------------------------------------------------------------
# Tab Format - Active Window
# ----------------------------------------------------------------------------
# Default: cyan | With Claude: color based on status
set -g window-status-current-format '\
#{?#{@claude_status},\
#[fg=#{?\
#{==:#{@claude_status},computing},red,\
#{?\
#{==:#{@claude_status},prompt},yellow,\
#{?\
#{==:#{@claude_status},unread},brightcyan,\
green}}}],\
#[fg=cyan]}\
#[bg=colour16,bright] #I.#W '

# ----------------------------------------------------------------------------
# Hooks
# ----------------------------------------------------------------------------

# When switching to a window, clear "unread" -> "idle"
set-hook -g session-window-changed '\
    if-shell \
        "[ \"$(tmux show-option -wqv @claude_status)\" = \"unread\" ]" \
        "set-option -w @claude_status idle"'

# On tmux restart, restore colors for windows running Claude
set-hook -g client-attached \
    'run-shell "$HOME/dotfiles/claude/integration-tmux/tmux-init.sh"'
